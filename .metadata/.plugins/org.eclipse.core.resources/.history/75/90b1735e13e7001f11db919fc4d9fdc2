package com.aurionpro.model;

import java.io.*;
import java.util.*;

public class MovieManager {
	private List<Movie> movies;
	private static final String filePath = "data.bin";

	public MovieManager() {
		movies = new ArrayList<>();
		loadMovies();
	}

	public void addMovie(Movie movie) {
		if (movies.size() < 5) {
			movies.add(movie);
			saveMovies();
		}
			System.out.println("Maximum 5 movies can be added !!");
	}

	public void clearMovies() {
		movies.clear();
		saveMovies();
	}

	public List<Movie> getMovies() {
		return movies;
	}

	public int getMovieId() {
		return movies.size() + 1;
	}

	// Deserialization
	public void loadMovies() {
		File file = new File(filePath);
		if (file.exists()) {
			try (ObjectInputStream objectInputStream = new ObjectInputStream(new FileInputStream(file))) {
				movies = (List<Movie>) objectInputStream.readObject();
				objectInputStream.close();
			} catch (IOException | ClassNotFoundException e) {
				System.out.println(e);
			}
		}
	}

	
	// Serialization
	public void saveMovies() {
		try (ObjectOutputStream objectOutputStream = new ObjectOutputStream(new FileOutputStream(filePath))) {
			objectOutputStream.writeObject(movies);
			objectOutputStream.close();
		} catch (IOException e) {
			System.out.println(e);
		}
	}

	public void deleteAllMovies() {
		File file = new File(filePath);
		if (file.exists()) {
			file.delete();
		}
		movies.clear();
	}
}